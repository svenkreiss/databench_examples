{% extends "templates/analysis.html" %}

{% block title %}bagofcharsd3{% end %}


{% block head %}
<style>
path.slice {
    stroke-width: 2px;
}
polyline {
    opacity: .3;
    stroke: black;
    stroke-width: 2px;
    fill: none;
}
</style>
{% end %}


{% block content %}
<h1>Bag of Chars</h1>

<input type="text" class="form-control" id="sentence"
       placeholder="type a phrase"
       autocomplete="off" autofocus />

<br />
<div id="viz" style="height: 300px; width: 100%;"></div>

[[ include_md('bagofcharsd3/README.md') ]]

<h3>Log</h3>
<pre id="log"></pre>
{% end %}


{% block footerscripts %}
<script src="/bagofcharsd3/static/d3charcount.js?version=1"></script>
<script>
    var databench = Databench();

    $('#sentence').on('keyup', function(event) {
        databench.emit('sentence', {sentence: $(this).val()});
    });


    var d3viz = d3charcount('viz');

    databench.on('counts', function(msg) {
        var reformattedData = Object.keys(msg).map(function(letter) {
            return {label:letter, value:msg[letter]};
        });
        if (reformattedData.length > 0) d3viz(reformattedData);
    });

    databench.emit('sentence', {sentence:'type a phrase'});
</script>
{% end %}
